"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addFnRoutes = void 0;
const constants_1 = require("../../../../util_modules/constants");
function addFnRoutes(app, details, proxy) {
    const fnTarget = details.target;
    app.use(`/server/${fnTarget.name}`, (req, res) => {
        proxy.web(req, res, {
            target: `http://127.0.0.1:${details.httpPort}${fnTarget.type === constants_1.FN_TYPE.basic ? `/server/${fnTarget.name}/execute` : ''}`,
            ws: true
        });
    });
    app.use(`/baas/v1/project/:projectId/function/${fnTarget.name}`, (req, res) => {
        proxy.web(req, res, {
            target: `http://127.0.0.1:${details.httpPort}${fnTarget.type === constants_1.FN_TYPE.basic ? `/server/${fnTarget.name}/execute` : ''}`,
            ws: true
        });
    });
    if (fnTarget.id) {
        app.use(`/server/${fnTarget.id}`, (req, res) => {
            proxy.web(req, res, {
                target: `http://127.0.0.1:${details.httpPort}${fnTarget.type === constants_1.FN_TYPE.basic ? `/server/${fnTarget.id}/execute` : ''}`,
                ws: true
            });
        });
        app.use(`/baas/v1/project/:projectId/function/${fnTarget.id}`, (req, res) => {
            proxy.web(req, res, {
                target: `http://127.0.0.1:${details.httpPort}${fnTarget.type === constants_1.FN_TYPE.basic ? `/server/${fnTarget.id}/execute` : ''}`,
                ws: true
            });
        });
    }
}
exports.addFnRoutes = addFnRoutes;
